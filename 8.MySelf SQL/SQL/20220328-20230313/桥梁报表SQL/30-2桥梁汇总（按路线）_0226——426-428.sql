SELECT 
RTRIM(K0112) K0102,

RTRIM(CASE WHEN LEN(K0101)>9 THEN LEFT(K0101,4)ELSE K0101 END),
SUM(CASE WHEN K6007 = '1' THEN 1 ELSE 0 END) 特大座数,
SUM(CASE WHEN K6007 = '1' THEN ISNULL(K6008,0) ELSE 0 END) 特大延米,
SUM(CASE WHEN K6007 = '2' THEN 1 ELSE 0 END) 大桥座数,
SUM(CASE WHEN K6007 = '2' THEN ISNULL(K6008,0) ELSE 0 END) 大桥延米,
SUM(CASE WHEN K6007 = '3' THEN 1 ELSE 0 END) 中桥座数,
SUM(CASE WHEN K6007 = '3' THEN ISNULL(K6008,0) ELSE 0 END) 中桥延米,
SUM(CASE WHEN K6007 = '4' THEN 1 ELSE 0 END) 小桥座数,
SUM(CASE WHEN K6007 = '4' THEN ISNULL(K6008,0) ELSE 0 END) 小乔延米,
COUNT(CASE WHEN K6007 in( '1','2','3','4') THEN 1 ELSE 0 END) 总座数,
SUM(K6008)总延米
FROM k060
WHERE  LEFT(K0101,1) NOT IN ('H','T') 
GROUP BY  RTRIM(K0112),RTRIM(CASE WHEN LEN(K0101)>9 THEN LEFT(K0101,4)ELSE K0101 END) WITH ROLLUP

order by k0102