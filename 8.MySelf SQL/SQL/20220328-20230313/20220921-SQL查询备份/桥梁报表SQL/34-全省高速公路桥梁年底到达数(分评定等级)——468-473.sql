
SELECT RTRIM(HA0102),
COUNT(*) 总座数,
SUM(K6008)总延米,
 --LEFT(A1305,4),
SUM(CASE WHEN K6028 = '1' THEN 1 ELSE 0 END) 一类座数,
SUM(CASE WHEN K6028 = '1' THEN ISNULL(K6008,0) ELSE 0 END) 一类延米,
SUM(CASE WHEN K6028 = '2' THEN 1 ELSE 0 END) 二类座数,
SUM(CASE WHEN K6028 = '2' THEN ISNULL(K6008,0) ELSE 0 END) 二类延米,
SUM(CASE WHEN K6028 = '3' THEN 1 ELSE 0 END) 三类座数,
SUM(CASE WHEN K6028 = '3' THEN ISNULL(K6008,0) ELSE 0 END) 三类延米,
SUM(CASE WHEN K6028 = '4' THEN 1 ELSE 0 END) 四类座数,
SUM(CASE WHEN K6028 = '4' THEN ISNULL(K6008,0) ELSE 0 END) 四类延米,
SUM(CASE WHEN K6028 = '5' THEN 1 ELSE 0 END) 五类座数,
SUM(CASE WHEN K6028 = '5' THEN ISNULL(K6008,0) ELSE 0 END) 五类延米,
SUM(CASE WHEN K6028 = '9' THEN 1 ELSE 0 END) 未评定座数,
SUM(CASE WHEN K6028 = '9' THEN ISNULL(K6008,0) ELSE 0 END) 未评定延米
FROM K060 
--WHERE   RTRIM(HA0102) ='湖北交投沙公南高速公路有限公司'--AND LEFT(A1305,4) <='2020'
--WHERE   LEFT(A1305,4) <='2020' OR A1305 IS NULL

GROUP BY  HA0102  WITH ROLLUP

