
SELECT 
	RTRIM(K1. A0102 ) A0102 --管理单位代码
	,RTRIM(K1.HA0102 ) HA0102 --管理单位
	,CASE WHEN LEN( RTRIM(K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END  K0101 --路线编号
--	,rtrim(K1.K0115) K0115
	,SUM(CASE WHEN K1.K0304='10'  THEN ISNULL(K1.K0114,0) END)	ZLC 
FROM
	K001 K1
WHERE
	LEFT ( K1.K0101, 1 ) IN ( 'G', 'S', 'Z' ) AND 
	K1.K0304='10' AND --高速
	ISNULL(K1.K0124,'')='' AND --重复路线
	--K1.A0102 ='42A72' AND 
	--K1.K0101 ='G59' AND
	--K1.A0102 ='42A53' AND 
	--K1.K0101 ='G6911' AND
	1=1
GROUP BY
	RTRIM(K1.A0102 )
	,RTRIM(K1.HA0102 )
--	,K1.K0115
	,K1.K0123
	 ,K1.K0192
	,CASE WHEN LEN( RTRIM( K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END

having grouping(RTRIM(K1.A0102 ))=grouping(RTRIM(K1.HA0102 ))
ORDER BY
	CASE WHEN LEN( RTRIM(K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END
	,SUM(CASE WHEN K1.K0304='10'  THEN ISNULL(K1.K0114,0) END)
	ASC
	