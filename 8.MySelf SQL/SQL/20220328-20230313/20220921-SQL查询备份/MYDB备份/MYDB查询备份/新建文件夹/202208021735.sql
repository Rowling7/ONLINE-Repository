
SELECT 
	RTRIM(K1. A0102 ) A0102 --管理单位代码
	,RTRIM(K1.HA0102 ) HA0102 --管理单位
	,CASE WHEN LEN( RTRIM(K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END  K0101 --路线编号
	,SUM(CASE WHEN K1.K0304='10'  THEN ISNULL(K1.K0114,0) END)	ZLC 
	,RTRIM(K1.K0115)+0 k0115
	,RTRIM(K1.K0115)+1 k0115
	--,CASE WHEN RTRIM(K1.K0115)=RTRIM(K1.K0115)  THEN 1 ELSE 0 END row
FROM
	K001 K1
WHERE
	LEFT ( K1.K0101, 1 ) IN ( 'G', 'S', 'Z' ) AND 
	K1.K0304='10' AND --高速
	ISNULL(K1.K0124,'')='' AND --重复路线
	K1.A0102 ='42A57' AND 
	K1.K0101 ='G0422' 
GROUP BY
	RTRIM(K1.A0102 )
	,RTRIM(K1.HA0102 )
	,K1.K0115
	,CASE WHEN LEN( RTRIM( K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END




/*
--having grouping(RTRIM(K1.A0102 ))=grouping(RTRIM(K1.HA0102 ))
ORDER BY
	CASE WHEN LEN( RTRIM(K1.K0101 ) ) > 9 THEN LEFT ( RTRIM(K1.K0101 ), 4 ) ELSE RTRIM(K1.K0101 )  END
	--,SUM(CASE WHEN K1.K0304='10'  THEN ISNULL(K1.K0114,0) END)
	ASC
	*/
	