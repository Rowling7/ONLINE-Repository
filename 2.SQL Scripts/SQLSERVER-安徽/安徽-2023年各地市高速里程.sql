USE [HRP-GHSS2014]
SELECT
LEFT(A0103,4),
sum(CASE WHEN RTRIM(K0304)='10' THEN isnull(k0114,'')	ELSE 0 END ) 'GS'
FROM K01 
WHERE isnull(k0123,'2')='2' and nullif(k0124,'') is null
AND LEFT(K0101,1)IN ('G','s')AND RTRIM(K0304)='10'
GROUP BY LEFT(A0103,4) with rollup
ORDER BY LEFT(A0103,4)