SELECT A0102 AS 单位代码,HA0102 AS 单位名称,
[里程合计]=ISNULL(ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'X' AND  (k0124 is null or k0124 = '') and isnull(k0123,'2') = '2' and isnull(k0126,'2')='2' THEN K0114 ELSE 0 END),0) +
ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'Y' AND  (k0124 is null or k0124 = '') and isnull(k0123,'2') = '2' and isnull(k0126,'2')='2' THEN K0114 ELSE 0 END),0) +
ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'C' AND  (k0124 is null or k0124 = '') and isnull(k0123,'2') = '2' and isnull(k0126,'2')='2' THEN K0114 ELSE 0 END),0),0) ,
--去掉断头路，一副高速，重复路段
ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'X' AND K0123= '2'THEN K0114 ELSE 0 END),0) AS '县',
ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'Y' AND K0123= '2'THEN K0114 ELSE 0 END),0) AS '乡',
ISNULL(SUM(CASE WHEN  LEFT(RTRIM(K0101), 1) = 'C'AND K0123= '2' THEN K0114 ELSE 0 END),0) AS '村'
FROM  K01
GROUP BY HA0102,A0102
ORDER BY A0102 ASC
